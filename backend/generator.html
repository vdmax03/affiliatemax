<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Gambar Nano-Banana</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .card { background-color: #1e293b; border: 1px solid #334155; }
        .btn-primary { background-color: #4f46e5; color: #ffffff; transition: background-color 0.2s; }
        .btn-primary:hover { background-color: #4338ca; }
        .btn-toggle { background-color: #334155; color: #cbd5e1; border: 1px solid #475569; transition: background-color 0.2s; }
        .btn-toggle.active { background-color: #4f46e5; color: #ffffff; }
        .input-text, .input-file { background-color: #334155; color: #cbd5e1; border: 1px solid #475569; }
    </style>
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="Cache-Control" content="no-store" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <script>
        const API_GENERATE = '/api/generate_image.php';
        const API_SUGGEST = '/api/suggest_prompts.php';
    </script>
    <meta name="color-scheme" content="dark">
    <meta name="theme-color" content="#0f172a">
</head>
<body class="p-6">
    <div class="max-w-7xl mx-auto flex flex-col lg:flex-row gap-6">

        <div class="lg:w-1/3 w-full space-y-6">
            <!-- API Key Input -->
            <div class="card p-6 rounded-2xl shadow-lg">
                <h2 class="text-xl font-semibold mb-2">Gemini API Key</h2>
                <input id="api-key-input" type="password" placeholder="Enter API key" class="input-text w-full p-3 rounded-lg" />
                <div class="flex justify-end mt-3">
                    <button id="save-key-btn" class="px-4 py-2 bg-gray-600 rounded-xl text-gray-200 hover:bg-gray-500">Save</button>
                </div>
                <p id="key-hint" class="text-xs text-gray-400 mt-2">Stored locally in this browser. Used for all requests.</p>
            </div>
            <div class="card p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-4">Generation Mode</h2>
                <div class="flex space-x-2">
                    <button id="image-to-video-btn" class="btn-toggle flex-1 p-3 rounded-xl font-semibold">Image to Video</button>
                    <button id="text-to-image-btn" class="btn-toggle flex-1 p-3 rounded-xl font-semibold active">Text to Image</button>
                    <button id="image-to-image-btn" class="btn-toggle flex-1 p-3 rounded-xl font-semibold">Image to Image</button>
                </div>
            </div>

            <!-- Image-to-Image Uploads -->
            <div id="upload-section" class="card p-6 rounded-2xl shadow-lg hidden">
                <h2 class="text-2xl font-semibold mb-4 flex items-center">Upload Source Images</h2>
                <div class="mb-4">
                    <p class="font-medium mb-2">Master Product Image</p>
                    <label class="w-full flex flex-col justify-center items-center py-4 px-6 border-2 border-dashed border-gray-500 rounded-xl cursor-pointer hover:bg-slate-800 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 14.899A6.999 6.999 0 0 1 12 2C16.971 2 21 6.029 21 11c0 3.865-2.204 7.218-5.385 8.868"></path>
                            <path d="M12 12v9m-4-4l4 4 4-4"></path>
                        </svg>
                        <span class="text-gray-400 text-lg">Click to upload image</span>
                        <input type="file" id="master-upload" accept="image/*" class="hidden">
                    </label>
                    <p class="text-xs text-gray-400 mt-1">(Max 5MB)</p>
                    <div id="master-preview" class="mt-2"></div>
                </div>
                <div>
                    <p class="font-medium mb-2">Secondary Product Image (Optional for Shop-the-Look)</p>
                    <label class="w-full flex flex-col justify-center items-center py-4 px-6 border-2 border-dashed border-gray-500 rounded-xl cursor-pointer hover:bg-slate-800 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 14.899A6.999 6.999 0 0 1 12 2C16.971 2 21 6.029 21 11c0 3.865-2.204 7.218-5.385 8.868"></path>
                            <path d="M12 12v9m-4-4l4 4 4-4"></path>
                        </svg>
                        <span class="text-gray-400 text-lg">Click to upload image</span>
                        <input type="file" id="secondary-upload" accept="image/*" class="hidden">
                    </label>
                    <p class="text-xs text-gray-400 mt-1">(Max 5MB)</p>
                    <div id="secondary-preview" class="mt-2"></div>
                </div>
            </div>

            <!-- Prompt and Resolution -->
            <div class="card p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-2" id="prompt-title">Text to Image Prompt</h2>
                <p class="text-gray-400 mb-4" id="prompt-subtext">Describe the image you want to generate...</p>
                <textarea id="prompt-input" rows="5" placeholder="Describe the image you want to generate..." class="input-text w-full p-3 rounded-lg resize-none"></textarea>
                <div id="resolution-row" class="mt-4">
                    <p class="font-medium mb-2">Output Resolution</p>
                    <div class="flex gap-2 flex-wrap">
                        <label class="flex items-center gap-2 cursor-pointer bg-slate-700/50 px-3 py-2 rounded-lg">
                            <input type="radio" name="ar" value="1:1" checked>
                            <span>1:1 Square</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer bg-slate-700/50 px-3 py-2 rounded-lg">
                            <input type="radio" name="ar" value="16:9">
                            <span>16:9 Landscape</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer bg-slate-700/50 px-3 py-2 rounded-lg">
                            <input type="radio" name="ar" value="9:16">
                            <span>9:16 Portrait</span>
                        </label>
                    </div>
                </div>
                <div class="flex justify-end mt-4 space-x-2">
                    <button id="clear-prompt-btn" class="px-4 py-2 bg-gray-600 rounded-xl text-gray-200 hover:bg-gray-500 transition-colors">Clear</button>
                    <button id="generate-btn" class="btn-primary px-6 py-2 rounded-xl font-semibold">Generate Image</button>
                </div>
                <div id="suggested-prompts-container" class="mt-6 hidden">
                    <h3 class="text-lg font-medium mb-2">Saran Prompt</h3>
                    <div id="suggested-prompts" class="flex flex-wrap gap-2">
                        <div id="prompt-loading" class="text-gray-400">Memuat saran prompt...</div>
                    </div>
                </div>
            </div>

            <!-- Image-to-Video Section -->
            <div id="itv-section" class="card p-6 rounded-2xl shadow-lg hidden">
                <h2 class="text-2xl font-semibold mb-4">Upload Slideshow Images</h2>
                <label class="w-full flex flex-col justify-center items-center py-4 px-6 border-2 border-dashed border-gray-500 rounded-xl cursor-pointer hover:bg-slate-800 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 14.899A6.999 6.999 0 0 1 12 2C16.971 2 21 6.029 21 11c0 3.865-2.204 7.218-5.385 8.868"></path>
                        <path d="M12 12v9m-4-4l4 4 4-4"></path>
                    </svg>
                    <span class="text-gray-400 text-lg">Click to upload images</span>
                    <input type="file" id="itv-upload" multiple accept="image/*" class="hidden">
                </label>
                <div id="itv-preview" class="mt-4 grid grid-cols-2 md:grid-cols-3 gap-2"></div>
                <div class="flex justify-end mt-4">
                    <button id="itv-generate-btn" class="btn-primary px-6 py-2 rounded-xl font-semibold">Generate Video</button>
                </div>
                <div id="itv-status" class="mt-3 text-sm text-gray-300"></div>
            </div>
        </div>

        <div class="lg:w-2/3 w-full space-y-6">
            <div class="card p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-4">Generated Images</h2>
                <div id="generated-image-container" class="w-full flex items-center justify-center min-h-[400px] border-2 border-dashed border-gray-600 rounded-xl bg-gray-800 p-4">
                    <div id="initial-message" class="text-center text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <path d="M21 15l-5-5L5 21"></path>
                        </svg>
                        <p class="text-lg">No images generated yet</p>
                        <p class="text-sm">Select an asset from below or generate new ones.</p>
                    </div>
                    <img id="generated-image" src="" alt="Generated Image" class="hidden rounded-xl w-full h-auto object-contain">
                    <div id="loading" class="hidden text-center">
                        <svg class="animate-spin h-10 w-10 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <p class="mt-2 text-gray-400">Sedang memproses...</p>
                    </div>
                </div>
            </div>

            <div class="card p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-4">Recent Generations</h2>
                <div id="recent-generations" class="w-full flex items-center justify-center min-h-[200px] border-2 border-dashed border-gray-600 rounded-xl bg-gray-800">
                    <div class="text-center text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.736 2.684L2 8M22 8l-2.617 2.617C16.892 14.125 12 16.5 12 12a9 9 0 0 1 9-9"></path>
                        </svg>
                        <p>No history yet.</p>
                        <p class="text-sm">Start generating to see your history here.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API key handling
        const LS_KEY = 'geminiApiKey';
        function getApiKey() { try { return (localStorage.getItem(LS_KEY) || '').trim(); } catch { return ''; } }

        const imageToVideoBtn = document.getElementById('image-to-video-btn');
        const apiKeyInput = document.getElementById('api-key-input');
        const saveKeyBtn = document.getElementById('save-key-btn');
        if (apiKeyInput) apiKeyInput.value = getApiKey();
        if (saveKeyBtn) saveKeyBtn.addEventListener('click', () => { try { localStorage.setItem(LS_KEY, (apiKeyInput.value || '').trim()); } catch {} });
        const textToImageBtn = document.getElementById('text-to-image-btn');
        const imageToImageBtn = document.getElementById('image-to-image-btn');
        const uploadSection = document.getElementById('upload-section');
        const masterUpload = document.getElementById('master-upload');
        const secondaryUpload = document.getElementById('secondary-upload');
        const masterPreview = document.getElementById('master-preview');
        const secondaryPreview = document.getElementById('secondary-preview');
        const promptInput = document.getElementById('prompt-input');
        const promptTitle = document.getElementById('prompt-title');
        const promptSubtext = document.getElementById('prompt-subtext');
        const resolutionRow = document.getElementById('resolution-row');
        const generateBtn = document.getElementById('generate-btn');
        const generateRow = generateBtn.parentElement;
        const generatedImageContainer = document.getElementById('generated-image-container');
        const generatedImage = document.getElementById('generated-image');
        const initialMessage = document.getElementById('initial-message');
        const loadingIndicator = document.getElementById('loading');
        const recentGenerationsContainer = document.getElementById('recent-generations');
        const clearPromptBtn = document.getElementById('clear-prompt-btn');
        const suggestedPromptsContainer = document.getElementById('suggested-prompts-container');
        const suggestedPromptsDiv = document.getElementById('suggested-prompts');

        let generationMode = 'text-to-image';
        let masterImage = null;
        let secondaryImage = null;

        imageToVideoBtn.addEventListener('click', () => {
            generationMode = 'image-to-video';
            imageToVideoBtn.classList.add('active');
            textToImageBtn.classList.remove('active');
            imageToImageBtn.classList.remove('active');
            uploadSection.classList.add('hidden');
            suggestedPromptsContainer.classList.add('hidden');
            resolutionRow.classList.add('hidden');
            promptTitle.textContent = 'Image to Video';
            promptSubtext.textContent = 'Upload images below to generate a slideshow video.';
            promptInput.classList.add('hidden');
            document.getElementById('itv-section').classList.remove('hidden');
            generateRow.style.display = 'none';
        });

        textToImageBtn.addEventListener('click', () => {
            generationMode = 'text-to-image';
            imageToVideoBtn.classList.remove('active');
            textToImageBtn.classList.add('active');
            imageToImageBtn.classList.remove('active');
            uploadSection.classList.add('hidden');
            suggestedPromptsContainer.classList.add('hidden');
            resolutionRow.classList.remove('hidden');
            promptTitle.textContent = 'Text to Image Prompt';
            promptSubtext.textContent = 'Describe the image you want to generate...';
            promptInput.placeholder = 'Describe the image you want to generate...';
            promptInput.classList.remove('hidden');
            document.getElementById('itv-section').classList.add('hidden');
            generateBtn.textContent = 'Generate Image';
            generateRow.style.display = 'flex';
        });

        imageToImageBtn.addEventListener('click', () => {
            generationMode = 'image-to-image';
            imageToVideoBtn.classList.remove('active');
            imageToImageBtn.classList.add('active');
            textToImageBtn.classList.remove('active');
            uploadSection.classList.remove('hidden');
            suggestedPromptsContainer.classList.remove('hidden');
            suggestedPromptsDiv.innerHTML = `<div id="prompt-loading" class="text-gray-400">Silakan unggah foto untuk mendapatkan saran prompt...</div>`;
            resolutionRow.classList.add('hidden');
            promptTitle.textContent = 'Image to Image Prompt';
            promptSubtext.textContent = 'Describe changes to the master image...';
            promptInput.placeholder = 'Describe changes to the master image...';
            promptInput.classList.remove('hidden');
            document.getElementById('itv-section').classList.add('hidden');
            generateBtn.textContent = 'Generate Image from Master + Prompt';
            generateRow.style.display = 'flex';
        });

        function handleSingleUpload(inputEl, setState, previewEl) {
            inputEl.addEventListener('change', async (event) => {
                const file = event.target.files?.[0];
                if (!file) { setState(null); previewEl.innerHTML=''; return; }
                if (file.size > 5 * 1024 * 1024) { showMessage('Ukuran File Terlalu Besar', `File "${file.name}" melebihi batas 5MB.`); inputEl.value=''; return; }
                const dataUrl = await new Promise(res => { const r = new FileReader(); r.onload = e => res(e.target.result); r.readAsDataURL(file); });
                const base64 = String(dataUrl).split(',')[1];
                setState({ mimeType: file.type, data: base64, preview: String(dataUrl) });
                previewEl.innerHTML = `<img src="${dataUrl}" class="w-full h-32 object-cover rounded-xl"/>`;
                if (generationMode === 'image-to-image') fetchSuggestions();
            });
        }

        handleSingleUpload(masterUpload, (v)=>{ masterImage = v; }, masterPreview);
        handleSingleUpload(secondaryUpload, (v)=>{ secondaryImage = v; }, secondaryPreview);

        clearPromptBtn.addEventListener('click', () => { promptInput.value = ''; });

        generateBtn.addEventListener('click', async () => {
            const prompt = promptInput.value.trim();
            if (generationMode !== 'image-to-video' && !prompt) { showMessage('Prompt Kosong', 'Silakan masukkan prompt untuk menghasilkan gambar.'); return; }
            if (generationMode === 'image-to-image' && !masterImage) { showMessage('Gambar Tidak Ditemukan', 'Silakan unggah Master Product Image terlebih dahulu.'); return; }

            initialMessage.classList.add('hidden');
            generatedImage.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');
            generateBtn.disabled = true;
            generateBtn.textContent = 'Generating...';

            try {
                if (generationMode === 'text-to-image' || generationMode === 'image-to-image') {
                    let finalPrompt = prompt;
                    if (generationMode === 'text-to-image') {
                        const ar = document.querySelector('input[name="ar"]:checked')?.value || '1:1';
                        finalPrompt = `${prompt}\n\nPlease generate using aspect ratio ${ar}.`;
                    }
                    const images = generationMode === 'image-to-image' ? [masterImage, ...(secondaryImage ? [secondaryImage] : [])].map(x=>({mimeType:x.mimeType,data:x.data})) : [];
                    const response = await fetch(API_GENERATE, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ mode: generationMode === 'image-to-image' ? 'image_to_image' : 'text_to_image', prompt: finalPrompt, images, api_key: getApiKey() }) });
                    if (!response.ok) throw new Error('HTTP ' + response.status);
                    const result = await response.json();
                    loadingIndicator.classList.add('hidden');
                    if (result.success && result.image_base64) {
                        const mime = result.mime_type || 'image/jpeg';
                        generatedImage.src = `data:${mime};base64,${result.image_base64}`;
                        generatedImage.classList.remove('hidden');
                        addToRecentGenerations(result.image_base64, prompt, mime);
                    } else {
                        generatedImageContainer.innerHTML = `<span class="text-red-400">Gagal menghasilkan gambar. ${result.error ? result.error : 'Coba prompt lain.'}</span>`;
                    }
                }
            } catch (error) {
                console.error('Kesalahan API:', error);
                loadingIndicator.classList.add('hidden');
                generatedImageContainer.innerHTML = `<span class="text-red-400">Terjadi kesalahan. Silakan coba lagi nanti.</span>`;
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'Generate Image';
            }
        });

        async function fetchSuggestions() {
            try {
                const imgs = [masterImage, secondaryImage].filter(Boolean).map(x=>({mimeType:x.mimeType, data:x.data}));
                if (!imgs.length) return;
                suggestedPromptsDiv.innerHTML = `<div id="prompt-loading" class="text-gray-400">Memuat saran prompt...</div>`;
                const response = await fetch(API_SUGGEST, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ images: imgs, api_key: getApiKey() }) });
                if (!response.ok) throw new Error('HTTP ' + response.status);
                const result = await response.json();
                if (!result.success) throw new Error(result.error || 'Unknown error');
                suggestedPromptsDiv.innerHTML = '';
                result.suggestions.forEach(s => {
                    const button = document.createElement('button');
                    button.className = "prompt-suggestion px-4 py-2 bg-gray-700 rounded-full text-sm hover:bg-gray-600 transition-colors";
                    button.textContent = s;
                    button.addEventListener('click', () => { promptInput.value = s; });
                    suggestedPromptsDiv.appendChild(button);
                });
            } catch (e) {
                console.error('Saran Prompt gagal:', e);
                suggestedPromptsDiv.innerHTML = `<div class="text-red-400">Gagal memuat saran prompt. Silakan coba lagi.</div>`;
            }
        }

        // Image to Video logic
        const itvUpload = document.getElementById('itv-upload');
        const itvPreview = document.getElementById('itv-preview');
        const itvGenerateBtn = document.getElementById('itv-generate-btn');
        const itvStatus = document.getElementById('itv-status');
        let itvImages = [];

        itvUpload.addEventListener('change', async (event) => {
            const files = Array.from(event.target.files || []);
            itvPreview.innerHTML = '';
            itvImages = [];
            for (const f of files) {
                if (f.size > 5 * 1024 * 1024) { showMessage('Ukuran File Terlalu Besar', `File "${f.name}" melebihi batas 5MB.`); continue; }
                const dataUrl = await new Promise(res => { const r = new FileReader(); r.onload = e => res(e.target.result); r.readAsDataURL(f); });
                itvImages.push(String(dataUrl));
                const img = document.createElement('img');
                img.src = String(dataUrl);
                img.className = 'w-full h-32 object-cover rounded-xl';
                itvPreview.appendChild(img);
            }
        });

        itvGenerateBtn.addEventListener('click', async () => {
            if (!itvImages.length) { showMessage('Gambar Tidak Ditemukan', 'Silakan unggah minimal satu gambar.'); return; }
            itvStatus.textContent = 'Creating job...';
            try {
                const resp = await fetch('/api/create_job.php', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ user_id: 'guest', type: 'image_to_video', images: itvImages, duration_per_image: 3, fps: 30, resolution: '1080x1920' }) });
                const data = await resp.json();
                if (!resp.ok || !data.success) throw new Error(data.error || ('HTTP ' + resp.status));
                const jobId = data.job.id;
                itvStatus.textContent = 'Job created. Processing...';
                pollJob(jobId);
            } catch (e) {
                itvStatus.textContent = 'Failed to create job: ' + e.message;
            }
        });

        async function pollJob(id) {
            try {
                const res = await fetch(`/api/job_status.php?id=${encodeURIComponent(id)}`);
                const j = await res.json();
                if (!res.ok || !j.success) throw new Error(j.error || 'Job error');
                const s = j.job.status;
                itvStatus.textContent = `Status: ${s} (${j.job.progress}%)`;
                if (s === 'completed') {
                    if (j.job.preview_url) addVideoPreview(j.job.preview_url, j.job.video_url);
                    return;
                }
            } catch (e) {
                itvStatus.textContent = 'Polling error: ' + e.message;
            }
            setTimeout(() => pollJob(id), 2000);
        }

        function addToRecentGenerations(base64Image, prompt, mime='image/jpeg') {
            const historyItem = document.createElement('div');
            historyItem.className = "flex flex-col items-center p-2 rounded-xl border border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors cursor-pointer";
            historyItem.innerHTML = `
                <img src="data:${mime};base64,${base64Image}" alt="Recent Generation" class="rounded-xl w-32 h-32 object-cover mb-2">
                <p class="text-xs text-gray-400 truncate w-full px-1">${prompt}</p>
            `;
            recentGenerationsContainer.classList.remove("flex", "items-center", "justify-center");
            recentGenerationsContainer.classList.add("grid", "grid-cols-2", "md:grid-cols-3", "lg:grid-cols-4", "gap-4");
            const initialHistoryMessage = recentGenerationsContainer.querySelector(".text-center");
            if (initialHistoryMessage) initialHistoryMessage.remove();
            recentGenerationsContainer.prepend(historyItem);
        }

        function addVideoPreview(previewUrl, videoUrl) {
            const item = document.createElement('a');
            item.href = videoUrl || previewUrl;
            item.target = '_blank';
            item.className = 'flex flex-col items-center p-2 rounded-xl border border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors cursor-pointer';
            item.innerHTML = `
                <img src="${previewUrl}" alt="Video Preview" class="rounded-xl w-32 h-32 object-cover mb-2">
                <p class="text-xs text-gray-400 truncate w-full px-1">Image to Video</p>
            `;
            recentGenerationsContainer.classList.remove("flex", "items-center", "justify-center");
            recentGenerationsContainer.classList.add("grid", "grid-cols-2", "md:grid-cols-3", "lg:grid-cols-4", "gap-4");
            const initialHistoryMessage = recentGenerationsContainer.querySelector('.text-center');
            if (initialHistoryMessage) initialHistoryMessage.remove();
            recentGenerationsContainer.prepend(item);
        }

        function showMessage(title, message, isError = false) {
            const dialog = document.createElement('div');
            dialog.className = `fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 transition-opacity duration-300 ${isError ? 'bg-red-900 bg-opacity-50' : ''}`;
            dialog.innerHTML = `
                <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-sm w-full border border-gray-700 text-center">
                    <h3 class="text-xl font-bold mb-4 text-white">${title}</h3>
                    <p class="text-gray-300 mb-6">${message}</p>
                    <button class="bg-blue-600 text-white px-6 py-2 rounded-full hover:bg-blue-700 transition-colors">Tutup</button>
                </div>
            `;
            document.body.appendChild(dialog);
            dialog.querySelector('button').addEventListener('click', () => {
                dialog.classList.add('opacity-0');
                setTimeout(() => dialog.remove(), 300);
            });
        }
    </script>
</body>
</html>
